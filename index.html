<html>
<head>
  <meta charset="UTF-8">
  <!-- uncomment lines below to include extra p5 libraries -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.1.4/Chart.min.js"></script>
  <script src="jquery.csv.js"></script>
  <style> body {padding: 0; margin: 0;} </style>
</head>

<body>

<input type="file" id="fileinput" />

<canvas id="myChart" width="400" height="400"></canvas>

<pre id="fileDisplayArea"><pre>

<script>

// Check for the various File API support.
if (window.File && window.FileReader && window.FileList && window.Blob) {
  // Great success! All the File APIs are supported.
} else {
  alert('The File APIs are not fully supported in this browser.');
}

function readSingleFile(evt) {
    //Retrieve the first (and only!) File from the FileList object
    var f = evt.target.files[0]; 
    var fileDisplayArea = document.getElementById('fileDisplayArea');
    if (f) {
      var r = new FileReader();
      r.onload = function(e) { 
	      var contents = e.target.result;
        alert( "Got the file.n" 
              +"name: " + f.name + "n"
              +"type: " + f.type + "n"
              +"size: " + f.size + " bytesn"
              + "starts with: " + contents.substr(1, contents.indexOf("n"))
        );  
        fileDisplayArea.innerText = r.result;
        var CANarray = csvToArray(r.result);
        console.log(CANarray);
      }
      r.readAsText(f);
    } else { 
      alert("Failed to load file");
    }
  }

  document.getElementById('fileinput').addEventListener('change', readSingleFile, false);

//var data = $.csv.toArrays(dump077-07D.csv);
function csvToArray (csv) {
    rows  = csv.split("\n");
    return rows.map(function (row) {
    	return row.split(",");
    });
};

// Hard-coded for brevity, but you can set this variable with FileReader
var csv   = "the,quick,brown,fox\n"+
    	    "jumps,over,the,lazy,dog";

var array = csvToArray(csv);

console.log(array);

var ctx = document.getElementById('myChart').getContext('2d');

var myChart = new Chart(ctx, {
  type: 'line',
  data: {
    labels: ['1', '2', '3', '4', '5', '6', '7'],
    datasets: [{
      label: '078 byte0',
      data: [12, 19, 3, 17, 6, 3, 7],
      backgroundColor: "rgba(153,255,51,0.4)"
    }, {
      label: '076 byte0',
      data: [2, 29, 5, 5, 2, 3, 10],
      backgroundColor: "rgba(255,153,0,0.4)"
    }]
  }
});

</script>
</body>
</html>

